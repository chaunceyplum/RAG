{
    "url": "https://docs.snowflake.com/en/user-guide/snowflake-cortex/cortex-analyst/semantic-model-spec",
    "title": "Cortex Analyst semantic model specification | Snowflake Documentation",
    "paragraphs": [
        "Preview Feature \u2014 Open",
        "Available to accounts in most Snowflake regions. See Region Availability for a full list.",
        "Cortex Analyst allows users to ask questions about Snowflake data using natural language.\nTypically there is a gap between the vocabulary used by business users when asking data questions and the vocabulary used in the database\nschema. These users typically use business or domain specific terms, whereas the database schema may use abbreviations or terms\noften used in ETL pipelines. Database schemas also often lack the semantic details to help someone unfamiliar with a dataset to\nunderstand the data. This difference in vocabulary makes it challenging for Cortex Analyst to answer data questions with high precision.",
        "A semantic model is a lightweight mechanism that addresses these issues by allowing for the specification of additional semantic\ndetails about a dataset. These additional semantic details, like more descriptive names or synonyms, enable Cortex Analyst to\nanswer data questions much more reliably.",
        "Note",
        "Semantic models are considered metadata.",
        "Note",
        "Throughout this topic, the base database related artifacts are referred to as \u201cphysical\u201d artifacts and semantic model related artifacts as \u201clogical\u201d artifacts.",
        "The structure and concepts of the semantic model are similar to those in database schemas, but semantic models allow you to provide\nmore semantic information about your data.",
        "A core concept of Snowflake\u2019s semantic models is the logical table. A logical table can be thought of as a simple view over a\nphysical database table or view. Each logical table is a collection of logical columns, which are categorized into dimensions,\ntime_dimensions, and measures.",
        "A logical column can be either a reference to an underlying physical column or an expression involving one or more\nphysical columns. The expression can be simple, such as a string concatenation or a mathematical operation, or it can\ninclude aggregation expressions. For example, you can use an expression like SUM(click)/SUM(spend) for calculating\ncost-per-click (CPC).",
        "The semantic model can also contain a verified query repository (VQR), which can help\nimprove the accuracy and trustworthiness of results by providing a collection of questions and corresponding SQL queries\nto answer them.",
        "The semantic model for Cortex Analyst specification is in YAML. It provides the necessary\nsemantic information to answer natural language questions with high precision.",
        "The general syntax is:",
        "You can use the semantic model generator tool to\ngenerate a semantic model for use with Cortex Analyst. The tool offers multiple options for generating semantic models:\nthrough a Streamlit app, via the command line, or directly in your Python code. The Streamlit app is particularly\nconvenient, allowing you to create semantic models from scratch or iterate on existing ones uploaded to a Snowflake\nstage.",
        "Cortex Analyst supports SQL joins, enabling more advanced data analysis across multiple tables, especially in star schema structures.\nThis feature allows you to query data from fact tables and associated dimension tables with ease. Currently, Snowflake supports simple star schemas,\nwith validation constraints in place to ensure the accuracy of queries.",
        "A star schema is a widely used design in business intelligence (BI) that consists of:",
        "Fact tables: contain quantitative data, such as sales or revenue figures.",
        "Dimension tables: hold descriptive attributes related to the fact table, such as customer or product information.",
        "Joins in star schemas typically occur between fact tables and dimension tables based on one-to-one or many-to-one relationships.",
        "To enable joins in Cortex Analyst, update the semantic context YAML file by adding the relationship definitions\nafter the list of tables. See the example:",
        "Where:",
        "name: A unique identifier for the relationship.",
        "left_table and right_table: Logical table names as defined earlier in your YAML file.",
        "relationship_columns: Specifies equality joins only. Non-equality joins are currently not supported. Must use logical column names (no expressions allowed).",
        "join_type: Supports either left_outer or inner joins.",
        "relationship_type: Supports many_to_one or one_to_one relationships.",
        "To ensure proper join functionality, primary keys must be defined for the tables involved in relationships. See the example:",
        "For an example of star schema joins defined, see jaffle_shop_star_schema.yaml.",
        "For complicated schema structures beyond star schema, queries that involve non-simple patterns face the risk of fan trap or chasm trap.\nSnowflake is working on handling such scenarios to support more complicated schema shapes.",
        "Organize your YAML file by business domain or topic",
        "Structure your YAML files to align with specific business domains or topics, keeping the scope focused. For instance, create\nseparate semantic models for sales analytics and marketing analytics.",
        "Tailor your use cases based on the target audience, expected questions or KPIs, and required data. Well-defined use cases lead to\nricher semantic models and more effective data retrieval.",
        "Think from the end-user perspective",
        "Identify key questions that users are likely to ask about the topic and include only the tables and columns needed to answer\nthose questions.",
        "Use names and synonyms that are similar to the vocabulary used by your end users.",
        "Include important details in description fields that would be helpful to someone writing queries on this dataset\nfor the first time, such as the timezone of a DATETIME column.",
        "Capture complex calculations",
        "Incorporate more difficult or business-specific queries into expressions.",
        "Use wide tables instead of long tables",
        "If you have a table with columns like \u201cmetric\u201d and \u201cvalue\u201d, flatten the table so that each metric is a column. This\napproach provides the model with more semantic information on each metric.",
        "Review auto-generated descriptions",
        "If you\u2019re using the semantic model generator, it\nattempts to automatically generate descriptions for your tables and columns. Always review these descriptions to\nensure that they are reasonable and relevant; make modifications as needed.",
        "Start simple and expand gradually",
        "A well-scoped semantic file ensures higher precision and accuracy of results. Start with a small number of tables and columns and\nexpand the semantic model YAML gradually to cover more kinds of questions. Remember that YAML building is a continuous process.",
        "Include verified queries",
        "A verified query repository (VQR), which is a collection of plain-English questions and\nqueries that answer them, can help improve the accuracy and trustworthiness of results.",
        "Cortex Analyst imposes a 1MB size limit on the semantic model file to restrict the size of API inputs.",
        "Cortex Analyst performs in-memory retrieval of sample values and verified queries added to the semantic YAML. After\nremoving all sample values and verified queries, the semantic model cannot exceed 32K tokens (roughly 4 x 32K\ncharacters or approximately 128 KB). You can use the semantic model generator validation command to ensure your file\nstays within these limits. The limits might increase as support is added for models with larger context windows.",
        "A semantic model represents a collection of tables. The model contains descriptions of tables, each of which contains descriptions of\nspecifics aspects of the table. Each table described in the model maps to a physical base table in Snowflake.",
        "It has the following fields:",
        "Required",
        "A descriptive name for this semantic model.",
        "Must be unique and follow the unquoted identifiers requirements.\nIt also cannot conflict with Snowflake reserved keywords.",
        "Optional (recommended)",
        "A description of this semantic model, including details of what kind of analysis it\u2019s useful for.",
        "A list of logical tables in this semantic model.",
        "A logical table can be thought of as a view over a physical database table or view. It has the following fields:",
        "Required",
        "A descriptive name for this table.",
        "Must be unique and follow the unquoted identifiers requirements.\nIt also cannot conflict with Snowflake reserved keywords.",
        "A fully qualified name of the underlying base table in the database.",
        "Optional (recommended)",
        "A list of other terms/phrases used to refer to this table. Must be unique across synonyms within the logical table.",
        "A description of this table.",
        "A list of dimension columns in this table.",
        "A list of time dimension columns in this table.",
        "A list of measures in this table.",
        "Predefined filters on this table, if any.",
        "A dimension describes categorical values such as state, user_type, platform, etc. It has the following fields:",
        "Required",
        "A descriptive name for this dimension.",
        "Must be unique and follow the unquoted identifiers requirements.\nIt also cannot conflict with Snowflake reserved keywords.",
        "The SQL expression for this dimension. This could be a reference to a physical column or a SQL expression with one or more columns\nfrom the underlying base table.",
        "The data type of this dimension. For an overview of all data types in Snowflake see SQL data types reference.\nNote that VARIANT, OBJECT, GEOGRAPHY, and ARRAY are currently not supported.",
        "Optional (recommended)",
        "A list of other terms/phrases used to refer to this dimension. Must be unique across all synonyms in this semantic model.",
        "A brief description about this dimension, including what data it has.",
        "A boolean value that indicates this dimension has unique values.",
        "Sample values of this column, if any. Add any value that are likely to be referenced in the user questions.",
        "Specifies the Cortex Search Service to use for this dimension. It has the following fields:",
        "service: The name of the Cortex Search Service.",
        "literal_column: (optional) The column in the Cortex Search Service that contains the literal values.",
        "database: (optional) The database where the Cortex Search Service is located. Defaults to base_table\u2019s database.",
        "schema: (optional) The schema where the Cortex Search Service is located. Defaults to base_table\u2019s schema.",
        "This field replaces the cortex_search_service_name field, which could only specify the name. cortex_search_service_name has been deprecated.",
        "A time dimension describes time values, such as sale_date, created_at, and year. It has the following fields:",
        "Required",
        "A descriptive name for this time dimension.",
        "Must be unique and follow the unquoted identifiers requirements.\nIt also cannot conflict with Snowflake reserved keywords.",
        "The SQL expression for this column. This could be a reference to a physical column or a SQL expression with one or more columns from\nthe underlying base table.",
        "The data type of this time dimension. For an overview of all data types in Snowflake see SQL data types reference.\nNote that VARIANT, OBJECT, GEOGRAPHY, and ARRAY are currently not supported.",
        "Optional (recommended)",
        "A list of other terms/phrases used to refer to this time dimension. Must be unique across all synonyms in this semantic model.",
        "A brief description about this dimension, including what data it has. Provide information that\u2019ll help someone writing queries using\nthis table. For example, for DATETIME columns, specify the timezone of the data.",
        "A boolean value that indicates this column has unique values.",
        "Sample values of this column, if any. Add any values that are likely to be referenced in the user questions. This field is optional.",
        "A measure describes numerical values, such as revenue, impressions, and salary. It has the following fields:",
        "Required",
        "A descriptive name for this measure.",
        "Must be unique and follow the unquoted identifiers requirements.\nIt also cannot conflict with Snowflake reserved keywords.",
        "The SQL expression for this column. This could be a reference to a physical column or a SQL expression with one or more columns from\nthe underlying base table.",
        "The data type of this measure. For an overview of all data types in Snowflake see SQL data types reference.\nNote that VARIANT, OBJECT, GEOGRAPHY, and ARRAY are currently not supported.",
        "Optional (recommended)",
        "A list of other terms/phrases used to refer to this measure. Must be unique across all synonyms in this semantic model.",
        "A brief description about this measure, including what data this column has.",
        "A boolean value that indicates this column has unique values.",
        "The default aggregation applied to this column in the context of a grouping. Some example values are sum, avg, min, max, median,\ncount, count_distinct, etc.",
        "Sample values of this column, if any. Add any values that are likely to be referenced in the user questions.",
        "A filter represents a SQL expression that\u2019s used for filtering. It has the following fields:",
        "Required",
        "A descriptive name for this filter.",
        "Must be unique and follow the unquoted identifiers requirements.\nIt also cannot conflict with Snowflake reserved keywords.",
        "The SQL expression of this filter, referencing logical columns.",
        "Optional (recommended)",
        "A list of other terms/phrases used to refer to this filter. Must be unique across all synonyms in this semantic model.",
        "A brief description about this filter, including details of what this filter is typically used for.",
        "A base table is used to represent fully qualified table names. This is the physical table that a logical table maps to.\nIt has the following fields:",
        "Required",
        "Name of the database.",
        "Name of the schema.",
        "Name of the table.",
        "See Cortex Analyst Verified Query Repository for information on the purpose and structure of this section of the YAML file.",
        "This section shows an example semantic model YAML.",
        "This example assumes you have the following table in your schema:",
        "This table has cryptic column names and not much semantic information about the columns. The following is a\nsemantic model YAML that gives more semantic information about this table:",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}