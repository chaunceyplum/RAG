{
    "url": "https://docs.snowflake.com/en/sql-reference/constructs/qualify",
    "title": "QUALIFY | Snowflake Documentation",
    "paragraphs": [
        "Query syntax",
        "In a SELECT statement, the QUALIFY clause filters the results of window functions.",
        "QUALIFY does with window functions what HAVING does with aggregate functions and GROUP BY clauses.",
        "In the execution order of a query, QUALIFY is therefore evaluated after window functions are computed. Typically,\na SELECT statement\u2019s clauses are evaluated in the order shown below:",
        "From",
        "Where",
        "Group by",
        "Having",
        "Window",
        "QUALIFY",
        "Distinct",
        "Order by",
        "Limit",
        "The general form of a statement with QUALIFY is similar to the following\n(some variations in order are allowed, but are not shown):",
        "This generally follows the rules for the projection clause of a SELECT statement.",
        "The data source is usually a table, but can be another table-like data source, such as a view, UDTF (user-defined table function),\netc.",
        "The predicate is an expression that filters the result after aggregates and window functions are computed.\nThe predicate should look similar to a HAVING clause, but without the\nkeyword HAVING. In addition, the predicate can also contain window functions.",
        "See the Examples section (in this topic) for predicate examples.",
        "The QUALIFY clause requires at least one window function to be specified in at least one of the following clauses\nof the SELECT statement:",
        "The SELECT column list.",
        "The filter predicate of the QUALIFY clause.",
        "Examples of each of these are shown in the Examples section below.",
        "Expressions in the SELECT list, including window functions, can be referred to by the column alias defined in the\nSELECT list.",
        "QUALIFY supports aggregates and subqueries in the predicate. For aggregates, the same rules as for the HAVING clause\napply.",
        "The word QUALIFY is a reserved word.",
        "The Snowflake syntax for QUALIFY is not part of the ANSI standard.",
        "The QUALIFY clause simplifies queries that require filtering on the result of window functions. Without QUALIFY,\nfiltering requires nesting. The example below uses the ROW_NUMBER() function to return only the first row in each\npartition.",
        "Create and load a table:",
        "This query uses nesting rather than QUALIFY:",
        "This query uses QUALIFY:",
        "You can also use QUALIFY to reference window functions that are in the SELECT column list:",
        "You can see how the QUALIFY acts as a filter by removing the QUALIFY from the previous query and comparing the\noutput:",
        "The QUALIFY clause can also be combined with aggregates and can have subqueries in the predicate. For example:",
        "Was this page helpful?",
        "On this page"
    ]
}