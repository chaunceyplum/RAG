{
    "url": "https://docs.snowflake.com/en/user-guide/cost-attributing",
    "title": "Attributing cost | Snowflake Documentation",
    "paragraphs": [
        "An organization can gain insight into the cost of using Snowflake by attributing those costs to logical units within the organization\n(e.g. departments, environments, and projects). This chargeback or showback model is useful for accounting purposes, but it also allows\nan organization to identify which units are spending the most. This insight helps pinpoint areas of the organization that could benefit\nfrom controls and optimizations in order to reduce costs.",
        "Note",
        "Object tagging is available in Enterprise Edition or higher.",
        "The most direct, powerful way to attribute cost to different groupings like departments, environments, or projects is to tag specific\nresources using the object tagging feature. In this strategy, an administrator creates a tag\n(e.g. cost_center), then defines a list of possible values of the tag (e.g. sales, finance). In this example, each cost\ncenter gets a unique tag value. The tag/value combination is then assigned to resources used by a cost center. As these resources consume\ncredits, you can run reports grouped by the tag value. Because this tag value corresponds directly to a particular grouping within the\norganization, costs can be attributed accurately.",
        "Object tagging allows you to attribute cost based on something as general as an account or as specific as a table. Note that not all\ntaggable objects accumulate cost. From a cost management perspective, tagging an object only\nmakes sense if there is a schema view that contains usage or cost data related to that object. For a list of Snowflake usage and cost\nviews, see Exploring overall cost.",
        "Using object tags to attribute cost consists of three basic tasks:",
        "Design a tagging strategy and create the appropriate tags.",
        "Tag resources with the correct tag/value pair.",
        "Run reports based on usage and tag data.",
        "To help illustrate this workflow, consider a Snowflake account that:",
        "Has two cost centers: Sales and finance.",
        "Has three warehouses. Sales uses Warehouse1 and Warehouse2, while the finance department uses Warehouse3.",
        "In this example, the goal is to attribute warehouse costs associated with each warehouse to the appropriate department.",
        "Note",
        "The following example assumes that appropriate privileges have been granted to the role tag_admin. An organization can use the\ngranular tagging permissions to develop a secure tagging strategy.",
        "For this example, an administrator with the proper privileges creates a single tag called cost_center.",
        "The tag administrator applies the appropriate tag/value pair to the warehouses. For example, since the sales department uses both\nwarehouse1 and warehouse2, the same tag/value combination is applied to these two resources.",
        "Note",
        "If administrators want to control which values can be set on the object, they can use the optional allowed_values parameter when\ncreating the tag. For details, see CREATE TAG.",
        "You can attribute costs by reporting on the use of resources that have the cost_center tag. This data is available in\nSnowsight, or by querying the SNOWFLAKE.ACCOUNT_USAGE schema.",
        "Switch to a role that has access to the ACCOUNT_USAGE schema.",
        "Navigate to Admin \u00bb Cost Management.",
        "Select Consumption.",
        "From the Tags drop-down, select the cost_center tag.",
        "To focus on a specific cost center, select a value from the list of the tag\u2019s values.",
        "Select Apply.",
        "For more details about filtering in Snowsight, see Filter by tag.",
        "The Account Usage schema contains data about both resource usage and the tags in the schema.",
        "You can view the cost attribution for all warehouses in a given month with their tags and tag values. This query also identifies\nuntagged warehouses:",
        "For complete details about using object tags, see Object Tagging.",
        "You can use the QUERY_ATTRIBUTION_HISTORY view to attribute cost based on queries. The cost per query\nis the warehouse credit usage for executing the query. This cost does not include any other credit usage that is incurred as a result\nof query execution. For example, the following are not included in the query cost:",
        "Data transfer costs",
        "Storage costs",
        "Cloud services costs",
        "Costs for serverless features",
        "Costs for tokens processed by AI services",
        "For queries that are executed concurrently, the cost of the warehouse is attributed to individual queries based on the weighted average\nof their resource consumption during a given time interval.",
        "The cost per query does not include warehouse idle time. Idle time is a period of time in which no queries are running in the\nwarehouse and can be measured at the warehouse level.",
        "You can attribute warehouse and query costs by tag, user, or by query (for example, recurrent queries).",
        "You can use the QUERY_TAG parameter to allocate cost across different workloads. A query tag can be assigned at the\nsession level for a workload or a set of queries. For more information about tag-based attribution, see Attribution workflow.",
        "To set a query tag for a session, follow these steps:",
        "Create a tag. For example, create a tag for the finance team:",
        "Set a query tag for the current session:",
        "The finance tag is associated with all queries executed during the session.",
        "To view the warehouse cost of all tagged queries for the current month, execute the following statement. Note that this\nquery allocates the entire warehouse compute cost across tags (including idle time) for reconciliation:",
        "You can attribute warehouse cost by user. For example, to determine the total warehouse cost attributed to each user for\nthe current month, execute the following statement:",
        "For recurrent or similar queries, use the query_hash or query_parameterized_hash to group costs\nby query.",
        "To find the most expensive recurrent queries for the current month, execute the following statement:",
        "For an additional query based on query ID, see Examples.",
        "For stored procedures that issue multiple hierarchical queries, you can compute the attributed query costs for the\nprocedure by using the root query ID for the procedure.",
        "To find the root query ID for a stored procedure, use the ACCESS_HISTORY view. For example,\nto find the root query ID for a stored procedure, set the query_id and execute the following statements:",
        "For more information, see Example: Ancestor queries with stored procedures.",
        "To sum the query cost for the entire procedure, replace <root_query_id> and execute the following statements:",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}