{
    "url": "https://docs.snowflake.com/en/user-guide/data-load-azure-private",
    "title": "Azure private connectivity for external stages and Snowpipe automation | Snowflake Documentation",
    "paragraphs": [
        "Business Critical Feature",
        "This feature requires Business Critical (or higher). It is not available in government regions.",
        "To inquire about upgrading, please contact Snowflake Support.",
        "Preview Feature \u2014 Open",
        "Available to all accounts that are Business Critical Edition (or higher) in non-government regions.",
        "This topic provides configuration details to set up outbound private connectivity for the\nfollowing Snowflake features:",
        "Bulk loading from Microsoft Azure using an external stage.",
        "Automating Snowpipe for Microsoft Azure Blob Storage.",
        "The differences between configuring bulk loading and Snowpipe automation for private connectivity and configuring them for public network\ntraffic consists of the following:",
        "Setting USE_PRIVATELINK_ENDPOINT = TRUE for the required storage integration, stage, or notification integration.",
        "Creating a private connectivity endpoint for the external stage (bulk loading and Snowpipe automation).",
        "Creating a private connectivity endpoint for the notification integration (Snowpipe automation only).",
        "You pay for each private connectivity endpoint along with total data processed. For pricing of these items, see the Snowflake Service Consumption Table.",
        "You can explore the cost of these items by filtering on the following service types when querying billing views in the ACCOUNT_USAGE and ORGANIZATION_USAGE schemas:",
        "OUTBOUND_PRIVATELINK_ENDPOINT",
        "OUTBOUND_PRIVATELINK_DATA_PROCESSED",
        "For example, you can query the USAGE_IN_CURRENCY_DAILY view and filter on these service types.",
        "You can configure outbound public connectivity and outbound private connectivity for the same storage account. If you want to do this,\ncreate a dedicated storage integration for outbound public connectivity and specify USE_PRIVATELINK_ENDPOINT = FALSE.",
        "The USE_PRIVATELINK_ENDPOINT property of a storage integration or external stage determines whether it is accessed through private\nconnectivity or by traversing the public network. To use private connectivity, set USE_PRIVATELINK_ENDPOINT = TRUE.",
        "A stage that references a storage integration that specifies USE_PRIVATELINK_ENDPOINT = TRUE inherits the private endpoint\nconfiguration. As a result, if you are using a storage integration that is configured to use private connectivity, you do not need to\nspecify the USE_PRIVATELINK_ENDPOINT property in the stage, and you cannot modify the stage to set the\nUSE_PRIVATELINK_ENDPOINT property.",
        "These steps are unique to using outbound private connectivity with a storage integration to unload data to an external stage on Microsoft Azure.\nYou need to modify the flow if you are using the stage\u2019s CREDENTIALS property instead of referencing a storage integration.",
        "These steps are required for both bulk loading and Snowpipe automation.",
        "In Snowflake, call the SYSTEM$PROVISION_PRIVATELINK_ENDPOINT system function to provision a\nprivate connectivity endpoint in your Snowflake VNet to enable Snowflake to connect to your external Blob storage account using private\nconnectivity:",
        "This function binds the private endpoint to the hostname, which enables the storage integration to use the private endpoint to connect\nto the storage location.",
        "In the Azure Portal and as the owner of the Microsoft Azure Blob storage resource, approve the private endpoint. For details, see the\napproval process.",
        "In Snowflake, call the SYSTEM$GET_PRIVATELINK_ENDPOINTS_INFO function.",
        "When the output of the function includes \"status\": \"APPROVED, your connection from Snowflake to your storage account will be\nable to use private connectivity (after the other necessary Snowflake objects are enabled for outbound private connectivity).",
        "You can continue with the next steps while waiting for the \"APPROVED\" status.",
        "Create a storage integration and be sure to specify the USE_PRIVATELINK_ENDPOINT property:",
        "Create an external stage that references the storage integration:",
        "After the private endpoint has an \"APPROVED\" status, test unloading data from Snowflake to the external stage:",
        "View the result in your Microsoft Azure stage.",
        "Automating Snowpipe for Microsoft Azure Blob Storage requires you to create a notification integration. The following syntax update allows\nyou to configure the notification integration for private connectivity.",
        "This section modifies the procedures described in Automating Snowpipe for Microsoft Azure Blob Storage to highlight how to implement Snowpipe\nautomation with private connectivity. The only differences are provisioning private connectivity endpoints and configuring the\nUSE_PRIVATELINK_ENDPOINT property of the storage integration and notification integration.",
        "Create a storage integration and stage, along with its dedicated private connectivity endpoint, as described\nearlier in this document.",
        "Grant Snowflake access to the storage locations,\nas described in the Automating Snowpipe for Microsoft Azure Blob Storage topic.",
        "Configure the Event Grid Subscription,\nas described in the Automating Snowpipe for Microsoft Azure Blob Storage topic.",
        "In Snowflake, call the SYSTEM$PROVISION_PRIVATELINK_ENDPOINT system function to provision a\nprivate endpoint in your Snowflake VNet to enable Snowflake to connect to your Azure queue using private\nconnectivity:",
        "In the Azure Portal and as the owner of the Microsoft Azure Storage resource, approve the private endpoint. For information, see the\napproval process.",
        "In Snowflake, call the SYSTEM$GET_PRIVATELINK_ENDPOINTS_INFO function.",
        "When the output of the function includes \"status\": \"APPROVED, your connection from Snowflake to your storage account will be\nable to use private connectivity (after the other necessary Snowflake objects are enabled for outbound private connectivity).",
        "Important",
        "You must wait until the status is APPROVED before continuing with the next step.",
        "Retrieve the storage queue URL and tenant ID,\nas described in the Automating Snowpipe for Microsoft Azure Blob Storage topic.",
        "Create a notification integration and be sure to specify the USE_PRIVATELINK_ENDPOINT property:",
        "Grant Snowflake access to the storage queue,\nas described in the Automating Snowpipe for Microsoft Azure Blob Storage topic.",
        "Create a pipe with auto-ingest enabled, as described in the Automating Snowpipe for\nMicrosoft Azure Blob Storage topic.",
        "The process of disabling private connectivity varies depending on whether the endpoint was provisioned for a storage integration, an\nexternal stage, or a notification integration.",
        "If you no longer need the private connectivity endpoint for the external stage, unset the\nUSE_PRIVATELINK_ENDPOINT property on the stage or storage integration, and then call the\nSYSTEM$DEPROVISION_PRIVATELINK_ENDPOINT system function.",
        "Unlike storage integrations and external stages, you cannot unset the USE_PRIVATELINK_ENDPOINT property of a notification\nintegration. If you no longer need private connectivity, you need to drop the notification integration, then create a new one. After\nrecreating the notification integration, you can call the SYSTEM$DEPROVISION_PRIVATELINK_ENDPOINT system function to deprovision the\nendpoint.",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}