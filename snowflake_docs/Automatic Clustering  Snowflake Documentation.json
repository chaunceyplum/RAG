{
    "url": "https://docs.snowflake.com/en/user-guide/tables-auto-reclustering",
    "title": "Automatic Clustering | Snowflake Documentation",
    "paragraphs": [
        "Automatic Clustering is the Snowflake service that seamlessly and continually manages all reclustering, as needed, of clustered tables.",
        "Note that, after a clustered table is defined, reclustering does not necessarily start immediately. Snowflake only reclusters a clustered table if it will benefit from the\noperation.",
        "Note",
        "If manual reclustering is still available in your account, Automatic Clustering might not be enabled yet for your account. For more details, see Manual Reclustering \u2014 Deprecated.",
        "Automatic Clustering eliminates the need for performing any of the following tasks:",
        "Monitoring the state of clustered tables.",
        "Instead, as DML is performed on these tables, Snowflake monitors and evaluates the tables to determine whether they would benefit from reclustering, and automatically\nreclusters them, as needed.",
        "Designating warehouses in your account to use for reclustering.",
        "Snowflake performs automatic reclustering in the background, and you do not need to specify a warehouse to use.",
        "All you need to do is define a clustering key for each table (if appropriate) and Snowflake manages all future maintenance.",
        "You can suspend and resume Automatic Clustering for a clustered table at any time using ALTER TABLE \u2026 SUSPEND / RESUME RECLUSTER. While Automatic Clustering is suspended\nfor a table, the table is never automatically reclustered, regardless of its clustering state and, therefore, does not incur any related credit charges.",
        "You can also drop the clustering key on a clustered table at any time, which prevents all future reclustering on the table.",
        "Automatic Clustering is transparent and does not block DML statements issued against tables while they are being reclustered.",
        "With Automatic Clustering, Snowflake internally manages the state of clustered tables, as well as the resources (servers, memory, etc.) used for all automated clustering\noperations. This allows Snowflake to dynamically allocate resources as needed, resulting in the most efficient and effective reclustering.",
        "Also, Automatic Clustering does not perform any unnecessary reclustering. Reclustering is triggered only if/when the table would benefit from the operation.",
        "In most cases, no tasks are required to enable Automatic Clustering for a table. You simply define a\nclustering key for the table.",
        "However, the rule does not apply to tables created by cloning (CREATE TABLE \u2026 CLONE \u2026)\nfrom a source table that has clustering keys. The new table starts with Automatic Clustering suspended \u2013 even if Automatic\nClustering for the source table is not suspended. (This is true whether the CLONE command cloned the table, the schema\ncontaining the table, or the database containing the table.)",
        "Tip",
        "Before you define a clustering key for a table, consider the following conditions, which may cause reclustering activity (and corresponding credit charges):",
        "The table is not optimally-clustered. For more details, see Micro-partitions & Data Clustering.",
        "The clustering key on the table has changed.",
        "As such, we recommend starting with one or two selected tables and assessing the impact of Automatic Clustering on these tables. Once you are comfortable/familiar with how\nAutomatic Clustering performs reclustering, you can then define clustering keys for your other tables.",
        "For information about choosing optimal clustering keys, see Strategies for Selecting Clustering Keys.",
        "To add clustering to a table, you must also have USAGE or OWNERSHIP privileges on the schema and database that\ncontain the table.",
        "You can use SQL to view whether Automatic Clustering is enabled for a table:",
        "SHOW TABLES command.",
        "TABLES view (in the Snowflake Information Schema).",
        "TABLES view (in the Account Usage shared database).",
        "The AUTO_CLUSTERING_ON column in the output displays the Automatic Clustering status for each table, which can be used to determine whether to suspend or resume Automatic\nClustering for a given table.",
        "In addition, the CLUSTER_BY column (SHOW TABLES) or CLUSTERING_KEY column (TABLES view) displays the column(s) defined as the clustering key(s) for each table.",
        "To suspend Automatic Clustering for a table, use the ALTER TABLE command with a SUSPEND RECLUSTER clause. For example:",
        "To resume Automatic Clustering for a clustered table, use the ALTER TABLE command with a RESUME RECLUSTER clause. For example:",
        "Tip",
        "Before you resume Automatic Clustering on a clustered table, consider the following conditions, which may cause reclustering activity (and corresponding credit charges):",
        "The table is not optimally-clustered (e.g. significant DML has been performed on the table since it was last reclustered).",
        "The clustering key on the table has changed.",
        "For more details, see Micro-partitions & Data Clustering and Clustering Keys & Clustered Tables.",
        "The cost of enabling Automatic Clustering can be broken down into compute costs and storage costs.",
        "Snowflake uses serverless compute resources to cluster a table for the first time. It also uses compute resources to maintain that table in a well-clustered state as new data is added to the table. The more changes to a table, the higher the\nmaintenance costs.",
        "Because Automatic Clustering reorganizes existing data rather than creating additional storage, in many cases there are no additional\nstorage costs. However, reclustering can incur additional storage costs if it increases the size of\nFail-safe storage. For more information, see Credit and Storage Impact of Reclustering.",
        "Automatic Clustering consumes Snowflake credits, but does not require you to provide a virtual warehouse. Instead, Snowflake internally\nmanages and achieves efficient resource utilization for reclustering the tables.",
        "Your account is billed only for the actual credits consumed by automatic clustering operations on your clustered tables.",
        "Important",
        "After enabling or resuming Automatic Clustering on a clustered table, if it has been a while since the table was reclustered, you may\nexperience reclustering activity (and corresponding credit charges) as Snowflake brings the table to an optimally-clustered state. Once\nthe table is optimally-clustered, the reclustering activity will drop off.",
        "Likewise, defining a clustering key on an existing table or changing the clustering key on a clustered table may trigger reclustering and\ncredit charges.",
        "To prevent any unexpected credit charges, we recommend starting with one or two selected tables and observing the credit charges\nassociated with keeping the tables well-clustered as DML is performed. This will help you establish a baseline for the number of credits\nconsumed by reclustering activity.",
        "You can call the SYSTEM$ESTIMATE_AUTOMATIC_CLUSTERING_COSTS function to help estimate the compute cost of\nenabling Automatic Clustering for a table and maintaining the table in a well-clustered state. You can also call the function to help predict\nthe compute cost of changing the cluster key of a table.",
        "Important",
        "The cost estimates returned by the SYSTEM$ESTIMATE_AUTOMATIC_CLUSTERING_COSTS function are best efforts. The actual realized costs can vary by up to 100% (or, in rare cases, several times) from the estimated costs.",
        "Automatic clustering consumes credits as it uses serverless compute resources for the\nautomated background maintenance of each clustered table, including initial clustering and reclustering as needed. To learn how many\ncredits per compute-hour are consumed by automatic clustering, refer to the \u201cServerless Feature Credit Table\u201d in the\nSnowflake Service Consumption Table.",
        "Users with the proper privileges can view the cost of automatic clustering using Snowsight, the\nClassic Console, or SQL:",
        "Select Admin \u00bb Cost Management.",
        "Select Account  \u00bb Billing & Usage",
        "Automatic Clustering costs show up as a separate Snowflake-provided warehouse named  AUTOMATIC_CLUSTERING.",
        "Query either of the following:",
        "AUTOMATIC_CLUSTERING_HISTORY table function (in the Snowflake Information Schema).",
        "AUTOMATIC_CLUSTERING_HISTORY view (in Account Usage).",
        "The following queries can be executed against the AUTOMATIC_CLUSTERING_HISTORY view:",
        "Query: Automatic Clustering cost history (by day, by object)",
        "This query provides a list of tables with Automatic Clustering and the volume of credits consumed via the service over the last 30 days,\nbroken out by day. Any irregularities in the credit consumption or consistently high consumption are flags for additional investigation.",
        "Query: Automatic Clustering History & m-day average",
        "This query shows the average daily credits consumed by Automatic Clustering grouped by week over the last year. It can help identify\nanomalies in daily averages over the year so you can investigate spikes or unexpected changes in consumption.",
        "Note",
        "Resource monitors provide control over virtual warehouse credit usage; however, you cannot use\nthem to control credit usage for the Snowflake-provided warehouses, including the  AUTOMATIC_CLUSTERING\nwarehouse.",
        "Was this page helpful?",
        "On this page"
    ]
}