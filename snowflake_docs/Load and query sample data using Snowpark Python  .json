{
    "url": "https://docs.snowflake.com/en/user-guide/tutorials/tasty-bytes-python-load",
    "title": "Load and query sample data using Snowpark Python | Snowflake Documentation",
    "paragraphs": [
        "This tutorial uses a fictitious food truck brand named Tasty Bytes to show you how to load\nand query data in Snowflake using Snowpark Python.\nYou use a pre-loaded Python worksheet in Snowsight to complete these tasks.",
        "The following illustration provides an overview of Tasty Bytes.",
        "Note",
        "Snowflake bills a minimal amount for the on-disk storage used for the sample data in\nthis tutorial. The tutorial provides steps to drop the database and minimize storage\ncost.",
        "Snowflake requires a virtual warehouse to load the\ndata and execute queries. A running virtual warehouse consumes Snowflake credits.\nIn this tutorial, you will be using a 30-day trial account,\nwhich provides free credits, so you won\u2019t incur any costs.",
        "In this tutorial you will learn how to complete the following tasks using the\nSnowpark Python API:",
        "Create a database and schema.",
        "Create a stage that holds data in an Amazon S3 bucket.",
        "Create a DataFrame to specify the stage that is the source of the data.",
        "Create a table that contains data from files on a stage.",
        "Set up a DataFrame to query the new table and filter the data.",
        "This tutorial assumes the following:",
        "You have a supported browser.",
        "You have a trial account. If you do not have a trial account yet, you can sign up\nfor a free trial. You can choose any Snowflake Cloud Region.",
        "Your user is the account administrator and is granted the ACCOUNTADMIN system role. For more information, see\nUsing the ACCOUNTADMIN Role.",
        "Note",
        "This tutorial is only available to users with a trial account. The sample worksheet is not available\nfor other types of accounts.",
        "To access Snowsight over the public Internet, do the following:",
        "In a supported web browser, navigate to https://app.snowflake.com.",
        "Provide your account identifier or account URL.\nIf you\u2019ve previously signed in to Snowsight, you might see an account name that you can select.",
        "Sign in using your Snowflake account credentials.",
        "You can use Python worksheets to write and run Python code. Your trial account has access\nto a pre-loaded Python worksheet for this tutorial. The worksheet has the Python code that\nyou will run to create a database, load data into it, and query the data. For more information\nabout Python worksheets, see Writing Snowpark Code in Python Worksheets.",
        "To open the pre-loaded tutorial Python worksheet:",
        "Select Projects \u00bb Worksheets to open the list of worksheets.",
        "Open [Tutorial] Using Python to load and query sample data.",
        "Your worksheet looks similar to the following image.",
        "This pre-loaded Python worksheet automatically uses the ACCOUNTADMIN system role so that\nyou can view and manage objects in your account. For more information, see\nUsing the ACCOUNTADMIN Role.",
        "The worksheet also uses the COMPUTE_WH virtual warehouse. A warehouse provides\nthe required resources to create and manage objects and run SQL commands. These\nresources include CPU, memory, and temporary storage. For more information, see\nVirtual warehouses.",
        "Python worksheets let you use Snowpark Python\nin Snowsight to run SQL statements. This step in this tutorial describes the code in each step\nin the Python worksheet. When you use a Python worksheet, you cannot run individual blocks of\ncode separately. You must run the whole worksheet. Before you select Run in the worksheet,\nreview the following steps so that you better understand the Python code.",
        "In the open Python worksheet, this step includes the following code:",
        "This tutorial imports the snowpark package and selected classes and functions so that they\nare available to your code.",
        "This step in the worksheet includes the following code:",
        "This line defines the default main handler function. The handler function contains the code\nyou will run in this tutorial. This line passes in a Session object that you can use to\nexecute SQL statements in Snowflake.",
        "This line creates a database named tasty_bytes_sample_data. This database stores data\nin tables that you can manage and query. For more information, see Databases, Tables and Views - Overview.",
        "The code uses the\nsql\nmethod to create a DataFrame that\nrepresents the results of the SQL statement. In Snowpark, you can query and process data\nwith a DataFrame. The code also uses the\ncollect\nmethod to run the SQL statement represented by the DataFrame. The other lines of code in this step\nin the worksheet also use these methods.",
        "This line creates a schema named raw_pos in the tasty_bytes_sample_data\ndatabase. A schema is a logical grouping of database objects, such as tables and views.\nFor example, a schema might contain the database objects required for a specific application.",
        "This line creates a stage named blob_stage. A stage is a location that holds data files to load\ninto a Snowflake database. This tutorial creates a stage that loads data from an Amazon S3 bucket. The\ntutorial uses an existing bucket with a CSV file that contains the data. It loads the data from this CSV\nfile into the table that is created later in this tutorial. For more information, see Bulk loading from Amazon S3.",
        "This step in the worksheet includes the following code:",
        "This code creates a StructType object named menu_schema. This object consists of a list\nof StructField objects that describe the fields in the CSV file in the stage. For more information,\nsee Working With Files in a Stage.",
        "This step in the worksheet includes the following code:",
        "This line creates the df_blob_stage_read DataFrame. This DataFrame is configured to read data from\nthe CSV file located in the specified stage, using the specified menu_schema schema. The schema\ncontains information about the types and names of the columns of data.",
        "This code uses the\nsave_as_table\nmethod to create the menu table and load the data from the stage into it.",
        "This step in the worksheet includes the following code:",
        "This line creates the df_menu_freezing_point DataFrame and configures it to query the\nmenu table. The\nfilter\nmethod prepares the SQL for execution with a conditional expression. The conditional expression filters the rows\nin the menu table to return the rows where the truck_brand_name column equals Freezing Point\n(similar to a WHERE clause).",
        "This line returns the df_menu_freezing_point DataFrame so that the query is ready for execution.\nDataFrames are lazily evaluated, which means that this line does not send the query to the server for\nexecution.",
        "When you are ready, select Run to run the code and view the output. When you select Run, the\nPython worksheet executes the Python code, which generates and executes the SQL statements. The query\nfor the returned DataFrame is executed, and the results are displayed in the worksheet.",
        "Your output looks similar to the following image.",
        "Congratulations! You have successfully completed this tutorial for trial accounts.",
        "Take a few minutes to review a short summary and the key points covered in this tutorial.\nConsider cleaning up by dropping any objects you created in this tutorial. Learn more by reviewing\nother topics in the Snowflake Documentation.",
        "If the objects you created in this tutorial are no longer needed,\nyou can remove them from the system with DROP <object> commands.\nTo remove the database you created, run the following command:",
        "In summary, you used a pre-loaded Python worksheet in Snowsight to complete the following\nsteps in Python code:",
        "Import Snowpark modules for a Python application.",
        "Create a Python function.",
        "Create a database and schema.",
        "Create a stage that holds data in an Amazon S3 bucket.",
        "Create a DataFrame to specify the source of the data in a stage.",
        "Create a table that contains data from files on the stage,",
        "Set up a DataFrame to query the new table and filter the data.",
        "Here are some key points to remember about loading and querying data:",
        "You used Snowpark to execute SQL statements in Python code.",
        "You created a stage to load data from a CSV file.",
        "You created a database to store the data and a schema to group the database objects logically.",
        "You used a DataFrame to specify the data source and filter data for a query.",
        "Continue learning about Snowflake using the following resources:",
        "Complete the other tutorials provided by Snowflake:",
        "Snowflake Tutorials",
        "Familiarize yourself with key Snowflake concepts and features, as well as the Snowpark Python classes and\nmethods used to perform queries and insert/update data:",
        "Introduction to Snowflake",
        "Snowpark Python",
        "Try the Tasty Bytes Quickstarts provided by Snowflake:",
        "Tasty Bytes Quickstarts",
        "Was this page helpful?"
    ]
}