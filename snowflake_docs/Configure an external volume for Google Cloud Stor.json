{
    "url": "https://docs.snowflake.com/en/user-guide/tables-iceberg-configure-external-volume-gcs",
    "title": "Configure an external volume for Google Cloud Storage | Snowflake Documentation",
    "paragraphs": [
        "Grant Snowflake restricted access to a Google Cloud Storage (GCS) bucket\nusing an external volume.",
        "Before you configure an external volume, you need the following:",
        "A Google Cloud Storage bucket in the same region that hosts your Snowflake account.",
        "To use the external volume for externally managed Iceberg tables, all of your table data and metadata files must\nbe located in the bucket.",
        "To support data recovery, enable versioning for your external cloud storage location.",
        "Permissions in Google Cloud to create and manage IAM policies and roles. If you aren\u2019t a Google Cloud administrator,\nask your Google Cloud administrator to perform these tasks.",
        "Create an external volume using the CREATE EXTERNAL VOLUME command.",
        "Note",
        "Only account administrators (users with the ACCOUNTADMIN role) can execute this SQL command.",
        "The following example creates an external volume that defines a single GCS storage location with encryption:",
        "To retrieve the ID for the GCS service account that was created automatically\nfor your Snowflake account, use the DESCRIBE EXTERNAL VOLUME command.\nSpecify the name of the external volume that you created previously.",
        "For example:",
        "Record the value of the STORAGE_GCP_SERVICE_ACCOUNT property in the output\n(for example, service-account-id@project1-123456.iam.gserviceaccount.com).",
        "Snowflake provisions a single GCS service account for your entire Snowflake account.\nAll GCS external volumes use that service account.",
        "In this step, you configure IAM access permissions for Snowflake in your Google Cloud console.",
        "Create a custom role that has the permissions required to access the bucket and get objects.",
        "Log in to the Google Cloud console as a project editor.",
        "From the home dashboard, select IAM & Admin \u00bb Roles.",
        "Select Create Role.",
        "Enter a Title and optional Description for the custom role.",
        "Select Add Permissions.",
        "In Filter, select Service and then select storage.",
        "Filter the list of permissions, and add the following from the list:",
        "storage.buckets.get",
        "storage.objects.create",
        "storage.objects.delete",
        "storage.objects.get",
        "storage.objects.list",
        "Select Add.",
        "Select Create.",
        "Log in to the Google Cloud console as a project editor.",
        "From the home dashboard, select Cloud Storage \u00bb Buckets.",
        "Filter the list of buckets, and select the bucket that you specified when you created an external volume.",
        "Select Permissions \u00bb View by principals, then select Grant access.",
        "Under Add principals, paste the name of the service account name from the\noutput in Step 2: Retrieve the GCS service account for your Snowflake account.",
        "Under Assign roles, select the custom IAM role that you created previously, then select Save.",
        "Note",
        "This step is required only if your GCS bucket is encrypted using a key stored in the\nGoogle Cloud Key Management Service (Cloud KMS).",
        "Log in to the Google Cloud console as a project editor.",
        "From the home dashboard, search for and select Security \u00bb Key Management.",
        "Select the key ring that is assigned to your GCS bucket.",
        "In the upper-right corner, select SHOW INFO PANEL. The information panel for the key ring appears.",
        "In the Add members field, search for the service account name from the DESCRIBE EXTERNAL VOLUME output\nin Step 2: Retrieve the GCS service account for your Snowflake account.",
        "From the Select a role dropdown, select the Cloud KMS CryptoKey Encrypter/Decrypter role.",
        "Select Add. The service account name is added to the Cloud KMS CryptoKey Encrypter/Decrypter\nrole dropdown in the information panel.",
        "To check that Snowflake can successfully authenticate to your storage provider, call the SYSTEM$VERIFY_EXTERNAL_VOLUME\nfunction.",
        "After you configure an external volume, you can create an Iceberg table.",
        "To create a read-only Iceberg table that uses an external catalog, see\nConfigure a catalog integration.",
        "To create an Iceberg table with full Snowflake platform support,\nsee Create a Snowflake-managed table.",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}