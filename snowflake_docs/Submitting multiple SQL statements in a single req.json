{
    "url": "https://docs.snowflake.com/en/developer-guide/sql-api/submitting-multiple-statements",
    "title": "Submitting multiple SQL statements in a single request | Snowflake Documentation",
    "paragraphs": [
        "This topic explains how to submit a request containing multiple statements to the Snowflake SQL API.",
        "Note",
        "Executing multiple statements in a single query requires that a valid warehouse is available in a session.",
        "In some cases, you might need to specify multiple SQL statements in a request. For example, you might need to:",
        "Define an explicit transaction",
        "Set and use session variables in statements in a request",
        "Create and use temporary tables in statements in a request",
        "Change the database, schema, warehouse, or role for statements in a request",
        "The following sections explain how to submit a request that contains multiple SQL statements.",
        "Specifying multiple SQL statements in the request",
        "Getting the results for each SQL statement in the request",
        "Handling errors when specifying multiple statements in a request",
        "To submit multiple SQL statements in a single request:",
        "In the statement field, use a semicolon (;) between each statement.",
        "In the parameters field, set the MULTI_STATEMENT_COUNT field to the number of SQL statements in the request.",
        "For example:",
        "In this example MULTI_STATEMENT_COUNT is set to 2 which corresponds to the number of SQL statements being submitted.",
        "To submit a variable number of SQL statements in the statement field, set MULTI_STATEMENT_COUNT to\n0. This is useful in an application where the number of SQL statements submitted is not known at runtime.",
        "If the value of MULTI_STATEMENT_COUNT does not match the number of SQL statements specified in the\nstatement field, the SQL API returns the following error:",
        "Where",
        "actual_count is the number of statements specified in the statement field.",
        "desired_count is the value of MULTI_STATEMENT_COUNT.",
        "If you specify multiple SQL statements in the statement field, but do not specify the\nMULTI_STATEMENT_COUNT field, the SQL API returns the following error:",
        "Note",
        "Snowflake does not currently support variable binding in multi-statement SQL requests.",
        "If a request that contains multiple SQL statements is processed successfully, the response does not include the data returned from\nexecuting the individual statements. Instead, the response contains a statementHandles field that contains an array of the\nhandles for the individual statements.",
        "Note",
        "The statementHandles field is different from the statementHandle field:",
        "The statementHandle field specifies the handle for the set of SQL statements in the request.",
        "The statementHandles field is an array of the handles of the individual SQL statements in the request.",
        "For example, suppose that you send a request that specifies two SQL statements for execution:",
        "The response contains a statementHandles field that contains an array of the handles for the individual statements.",
        "To check the status and retrieve the data for the individual statements, send a GET request to the\n/api/v2/statements/ endpoint and append the handle for each statement to the URL path. See\nChecking the status of the statement execution and retrieving the data for details.",
        "If you specified multiple SQL statements in the request and an error occurred when executing any of the statements, Snowflake\nreturns the HTTP response code 422 with a QueryFailureStatus object.",
        "You can get details about the error from this object.",
        "For example, suppose that your request specifies the following statements in which the second INSERT statement contains an error:",
        "Snowflake returns a response with the HTTP response code 422 and with a QueryFailureStatus object that contains the\ndetails about the error:",
        "In the example above, the INSERT statement with the error starts at the character position 75 in the value of the\nstatement field.",
        "The statements before the statement with the error are executed successfully (the CREATE TABLE and first INSERT statement in this\nexample). The statements after the statement with the error are not executed.",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}