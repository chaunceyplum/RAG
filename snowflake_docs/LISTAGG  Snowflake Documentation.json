{
    "url": "https://docs.snowflake.com/en/sql-reference/functions/listagg.html",
    "title": "LISTAGG | Snowflake Documentation",
    "paragraphs": [
        "Aggregate functions (General) , Window function syntax and usage (General)",
        "Returns the concatenated input values, separated by the delimiter string.",
        "Aggregate function",
        "Window function",
        "An expression (typically a column name) that determines the values to be put into the list.\nThe expression must evaluate to a string, or to a data type that can be\ncast to string.",
        "The OVER clause is required when the function is being used as a window function.\nFor details, see Window function syntax and usage.",
        "Removes duplicate values from the list.",
        "A string, or an expression that evaluates to a string. Typically, this value is\na single-character string. The string should be surrounded by single\nquotes, as shown in the examples below.",
        "If no delimiter is specified, an empty string is used as\nthe delimiter.",
        "The delimiter must be a constant.",
        "One or more expressions (typically column names) that determine the order of the values for\neach group in the list.",
        "The WITHIN GROUP (ORDER BY) syntax supports the same parameters as the\nORDER BY clause in a SELECT statement.",
        "Window function sub-clause that specifies an expression (typically a column name).\nThis expression defines partitions that group the input rows before the function is applied.\nFor details, see Window function syntax and usage.",
        "Returns a string that includes all of the non-NULL input values, separated by the delimiter.",
        "This function does not return a list or an array. It returns a single string that contains all\nof the non-NULL input values.",
        "If you do not specify WITHIN GROUP (ORDER BY), the order of elements within each list is unpredictable.\n(An ORDER BY clause outside the WITHIN GROUP clause applies to the order of the output rows, not to the order\nof the list elements within a row.)",
        "If you specify a number for an expression in WITHIN GROUP (ORDER BY), this number is parsed as a numeric\nconstant, not as the ordinal position of a column in the SELECT list. Therefore, do not specify numbers\nas WITHIN GROUP (ORDER BY) expressions.",
        "If you specify DISTINCT and WITHIN GROUP, both must refer to the same column. For example:",
        "If you specify different columns for DISTINCT and WITHIN GROUP, an error occurs:",
        "You must either specify the same column for DISTINCT and WITHIN GROUP or omit DISTINCT.",
        "Regarding NULL or empty input values:",
        "If the input is empty, an empty string is returned.",
        "If all input expressions evaluate to NULL, the output is an empty string.",
        "If some but not all input expressions evaluate to NULL, the output contains\nall non-NULL values and excludes the NULL values.",
        "When this function is called as a window function, it does not support:",
        "An ORDER BY clause within the OVER clause.",
        "Explicit window frames.",
        "The collation of the result is the same as the collation of the input.",
        "Elements inside the list are ordered according to collations, if the ORDER BY sub-clause specifies an expression\nwith collation.",
        "The delimiter cannot use a collation specification.",
        "Specifying collation inside ORDER BY does not impact the collation of the result. For example, the statement below\ncontains two ORDER BY clauses, one for LISTAGG and one for the query results. Specifying collation inside\nthe first one does not affect the collation of the second one. If you need to collate the output in both ORDER BY\nclauses, you must specify collation explicitly in both clauses.",
        "These examples use the LISTAGG function.",
        "The following examples use the LISTAGG function to concatenate values in the results of\nqueries on orders data.",
        "Note",
        "These examples query the TPC-H sample data. Before\nrunning the queries, execute the following SQL statement:",
        "This example lists the distinct o_orderkey values for orders with a o_totalprice greater than\n520000 and uses and empty string for the delimiter:",
        "This example lists the distinct o_orderstatus values for orders with a o_totalprice greater than\n520000 and uses a vertical bar for the delimiter:",
        "This example lists the o_orderstatus and o_clerk values of each order with a o_totalprice greater than\n520000 grouped by o_orderstatus. The query uses a comma for the delimiter:",
        "The following examples show collation with the LISTAGG function.\nThe examples use the following data:",
        "Note the difference in output order with the different\ncollation specifications. This query uses the es collation specification:",
        "This query uses the utf8 collation specification:",
        "Was this page helpful?",
        "On this page"
    ]
}