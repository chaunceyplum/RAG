{
    "url": "https://docs.snowflake.com/en/sql-reference/constructs/group-by-rollup.html",
    "title": "GROUP BY ROLLUP | Snowflake Documentation",
    "paragraphs": [
        "Query syntax",
        "GROUP BY ROLLUP is an extension of the GROUP BY clause that produces sub-total rows\n(in addition to the grouped rows). Sub-total rows are rows that further aggregate whose values are derived\nby computing the same aggregate functions that were used to produce the grouped rows.",
        "You can think of rollup as generating multiple result sets, each of which\n(after the first) is the aggregate of the previous result set. So, for example,\nif you own a chain of retail stores, you might want to see the profit for:",
        "Each store.",
        "Each city (large cities might have multiple stores).",
        "Each state.",
        "Everything (all stores in all states).",
        "You could create separate reports to get that information, but it is more\nefficient to scan the data once.",
        "If you are familiar with the concept of grouping sets\n(GROUP BY GROUPING SETS)\nyou can think of a ROLLUP grouping as equivalent to a series of grouping sets,\nand which is essentially a shorter specification. The N elements of\na ROLLUP specification correspond to N+1 GROUPING SETS.",
        "GROUP BY GROUPING SETS",
        "Where:",
        "Column alias appearing in the query block\u2019s SELECT list.",
        "Position of an expression in the SELECT list.",
        "Any expression on tables in the current scope.",
        "As the query is aggregated at higher and higher levels, it shows NULL values\nin more columns of each row. This is appropriate. For example, in the example\nbelow, for the aggregate at the state level, the city column is NULL;\nthat\u2019s because the value in the profit column does not correspond to one\ncity. Similarly, in the final total, which aggregates data from all the\nstates and all the cities, the revenue is not from one specific state or\none specific city, so both the state and city columns in that row are NULL.",
        "The query should list the \u201cmost significant level\u201d first in the parentheses\nafter the ROLLUP. For example, states contain cities, so if you are rolling up\ndata across states and cities, the clause should be",
        "...ROLLUP (state, city)",
        "If you reverse the order of the column names, you get a result that is\nprobably not what you want. In the example below, if you reversed the order\nof city and state in the ROLLUP clause, the result would be incorrect, at least in part because both California and\nPuerto Rico have a city named San Jose (\u201cSJ\u201d), and you probably would not want to\ncombine the revenue from the two different San Joses, except in the final\ntotal of all revenue. (An alternative way to avoid combining data from different cities\nwith the same name is to create a unique ID for each city and use the ID rather than the name in the query.)",
        "Start by creating and loading a table with information about sales from\na chain store that has branches in different cities and states/territories.",
        "Run a rollup query that shows profit by city, state, and total across all\nstates.",
        "The example below shows a query that has three \u201clevels\u201d:",
        "Each city.",
        "Each state.",
        "All revenue combined.",
        "This example uses ORDER BY state, city NULLS LAST to ensure that each state\u2019s rollup comes immediately after all of\nthe cities in that state, and that the final rollup appears at the end of the output.",
        "Some rollup rows contain NULL values. For example, the last row in the table contains a NULL value for the city and\na NULL value for the state because the data is for all cities and states, not a specific city and state.",
        "Was this page helpful?",
        "On this page"
    ]
}