{
    "url": "https://docs.snowflake.com/en/sql-reference/functions/max_by",
    "title": "MAX_BY | Snowflake Documentation",
    "paragraphs": [
        "Aggregate functions (General)",
        "Finds the row(s) containing the maximum value for a column and returns the value of another column in that row.",
        "For example, if a table contains the columns employee_id and salary, MAX_BY(employee_id, salary) returns the value\nof the employee_id column for the row that has the highest value in the salary column.",
        "If multiple rows contain the specified maximum value, the function is non-deterministic.",
        "To return values for multiple rows, specify the optional maximum_number_of_values_to_return argument. With this\nadditional argument:",
        "The function returns an ARRAY containing the values of a column for the rows with the highest\nvalues of a specified column.",
        "The values in the ARRAY are sorted by their corresponding values in the column containing the maximum values.",
        "If multiple rows contain these highest values, the function is non-deterministic.",
        "For example, MAX_BY(employee_id, salary, 5) returns an ARRAY of values of the employee_id column for the five rows\ncontaining the highest values in the salary column. The IDs in the ARRAY are sorted by the corresponding values in the\nsalary column.",
        "MAX",
        "Required:",
        "Column containing the value to return.",
        "Column containing the maximum value.",
        "Optional:",
        "Constant integer specifying the maximum number of values to return. You must specify a positive number. The maximum number that\nyou can specify is 1000.",
        "If maximum_number_of_values_to_return is not specified, the function returns a value of the same type as\ncol_to_return.",
        "If maximum_number_of_values_to_return is specified, the function returns an ARRAY containing values of the same type\nas col_to_return. The values in the ARRAY are sorted by their corresponding col_containing_maximum values.",
        "For example, MAX_BY(employee_id, salary, 5) returns the IDs of the employees with the highest five salaries, sorted by\nsalary (in descending order).",
        "The function ignores NULL values in col_containing_maximum.",
        "If all values in col_containing_maximum are NULL, the function returns NULL (regardless of whether the optional\nmaximum_number_of_values_to_return argument is specified).",
        "The following examples demonstrate how to use the MAX_BY function.",
        "To run these examples, execute the following statements to set up the table and data for the examples:",
        "Execute the following statement to view the contents of this table:",
        "The following example returns the ID of the employee with the highest salary:",
        "Note the following:",
        "Because more than one row contains the maximum value for the salary column, the function is non-deterministic and might\nreturn the employee ID for a different row in subsequent executions.",
        "The function ignores the NULL value in the salary column when determining the rows with the maximum values.",
        "The following example returns an ARRAY containing the IDs of the employees with the three highest salaries:",
        "As shown in the example, the values in the ARRAY are sorted by their corresponding values in the salary column. So,\nMAX_BY returns the IDs of employees sorted by their salary in descending order.",
        "If more than one of these rows contain the same value in the salary column, the order of the returned values for that salary\nis non-deterministic.",
        "See also Using the MIN_BY and MAX_BY aggregate functions.",
        "Was this page helpful?",
        "On this page"
    ]
}