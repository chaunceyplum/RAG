{
    "url": "https://docs.snowflake.com/en/sql-reference/sql/create-aggregation-policy",
    "title": "CREATE AGGREGATION POLICY | Snowflake Documentation",
    "paragraphs": [
        "Enterprise Edition Feature",
        "This feature requires Enterprise Edition (or higher). To inquire about upgrading, please contact Snowflake Support.",
        "Creates a new aggregation policy in the current/specified schema or replaces an existing\naggregation policy.",
        "After creating an aggregation policy, assign the aggregation policy to a table using an ALTER TABLE command or a view using an ALTER VIEW command.",
        "Aggregation policy DDL reference",
        "Identifier for the aggregation policy; must be unique for your schema.",
        "The identifier value must start with an alphabetic character and cannot contain spaces or special characters unless the entire identifier\nstring is enclosed in double quotes (e.g. \"My object\"). Identifiers enclosed in double quotes are also case-sensitive.",
        "For more details, see Identifier requirements.",
        "SQL expression that determines the restrictions of an aggregation policy.",
        "To define the constraints of the aggregation policy, use the SQL expression to call one or more of the following functions:",
        "When the policy body returns a value from this function, queries can return data from an aggregation-constrained table or view\nwithout restriction. For example, the body of the policy could call this function when an administrator needs to obtain unaggregated\nresults from the aggregation-constrained table or view.",
        "Call NO_AGGREGATION_CONSTRAINT without an argument.",
        "When the policy body returns a value from this function, queries must aggregate data in order to return results. Use the\nMIN_GROUP_SIZE argument to specify how many records must be included in each aggregation group.",
        "The syntax of the AGGREGATION_CONSTRAINT function is:",
        "Where:",
        "Specifies how many rows or entities must be included in the groups returned by\na query against the aggregation-constrained table or view.",
        "There is a difference between passing a 1 and a 0 as the argument to the function. Both require results to be aggregated.",
        "Passing a 1 also requires that each aggregation group contain at least one record from the aggregation-constrained table. So for\nouter joins, at least one record from the aggregation-constrained table must match a record from an unprotected table.",
        "Passing a 0 allows the query to return groups that consist entirely of records from another table. So for outer joins between an\naggregation-constrained table and an unprotected table, a group could consist of records from the unprotected table that do not match\nany records in the aggregation-constrained table.",
        "If you are using entity-level privacy with the aggregation policy, specifies how many rows and entities must be included in the\ngroups returned by a query against the aggregation-constrained table or view. Do not use the MIN_GROUP_SIZE parameter when using\nthese parameters. If you want to specify the number of rows or the number of entities, use MIN_GROUP_SIZE alone.",
        "The body of a policy cannot reference user-defined functions, tables, or views.",
        "Adds a comment or overwrites an existing comment for the aggregation policy.",
        "A role used to execute this SQL command must have the following\nprivileges at a minimum:",
        "Privilege",
        "Object",
        "Notes",
        "CREATE AGGREGATION POLICY",
        "Schema",
        "The USAGE privilege on the parent database and schema are required to perform operations on any object in a schema.",
        "For instructions on creating a custom role with a specified set of privileges, see Creating custom roles.",
        "For general information about roles and privilege grants for performing SQL actions on\nsecurable objects, see Overview of Access Control.",
        "For additional details on aggregation policy DDL and privileges, see Privileges and commands.",
        "If you want to update an existing aggregation policy and need to see the current body of the policy, run the\nDESCRIBE AGGREGATION POLICY command or GET_DDL function.",
        "Regarding metadata:",
        "Attention",
        "Customers should ensure that no personal data (other than for a User object), sensitive data, export-controlled data, or other regulated data is entered as metadata when using the Snowflake service. For more information, see Metadata fields in Snowflake.",
        "Create an aggregation policy that requires queries to return groups of five or more rows:",
        "Create an aggregation policy that allows a user with role admin to return unaggregated results while requiring all other queries\nto return groups of five or more rows:",
        "Was this page helpful?",
        "On this page"
    ]
}