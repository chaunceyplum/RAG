{
    "url": "https://docs.snowflake.com/en/user-guide/cost-controlling",
    "title": "Controlling cost | Snowflake Documentation",
    "paragraphs": [
        "This topic discusses the controls that you can use to limit how much is spent on\nvirtual warehouse usage. These controls help ensure that the actual cost of using virtual\nwarehouses does not exceed expected cost.",
        "These controls do not apply to cloud services and\nserverless features.",
        "Carefully defining who can work with warehouses and what they can do with those warehouses helps control cost by limiting compute resource\nusage to known warehouses that have cost-effective configurations. Snowflake\u2019s granular\naccess control allows you to grant the following privileges for warehouses:",
        "CREATE WAREHOUSE \u2014 Global privilege (i.e. granted on the account) that restricts which roles can create a new warehouse, allowing\nyou to force individuals to use existing warehouses that have cost controls in place.",
        "MODIFY \u2014 Privilege on a specific warehouse that allows changing the settings that affect cost, including resizing a warehouse and\ndisabling the auto-suspend setting. Commonly, users increase the size of a warehouse for a\nparticular workload and then forget to change it back to its original size, which can have a significant effect on cost.",
        "USAGE \u2014 Privilege on a specific warehouse that allows activating the warehouse to provide compute resources for queries and other\nSQL actions. Carefully assigning this privilege ensures that users can only use warehouses with the appropriate size and configuration\nfor their workloads.",
        "Centralizing the responsibility of creating and scaling warehouses to just a few members of your team is considered a best practice. You can\ncreate a dedicated role with permissions to create and modify all warehouses, and then grant that role to a limited number of users. This\nallows you to control your warehouse policies and prevent accidental cost overruns resulting from warehouses being created or upsized\nunexpectedly.",
        "Tip",
        "If you want the ability to scale a warehouse to handle more demanding workloads, but do not want to give users the ability to increase\nthe size of a warehouse because they might forget to resize it later, consider using a\nmulti-cluster warehouse. A multi-cluster warehouse scales automatically as workloads\nfluctuate.",
        "For a list of all the privileges that can be set for a warehouse, see Virtual warehouse privileges.",
        "The size of a warehouse determines the maximum number of credits that can be spent in an hour. For example, a Small warehouse cannot\nconsume more than 2 credits per hour. For a complete list of warehouse sizes along with the maximum number of credits they consume,\nsee Overview of warehouses.",
        "One best practice for cost control is to use different warehouses for different workloads, which allows you to choose a size that is\nappropriate for each workload. If you are not sure what is the best size for the warehouse, start with a smaller size and slowly increase\nit based on workload performance and its SLA.",
        "For more information about choosing the right warehouse for a workload, see\nManaging Snowflake Compute Resources (Snowflake blog post).",
        "Hung queries consume excessive credits because they run longer than expected. To avoid the excess cost associated with a\nrunaway query, you can set the STATEMENT_TIMEOUT_IN_SECONDS parameter to define the maximum amount of time a SQL statement can run\nbefore it is cancelled.",
        "The STATEMENT_TIMEOUT_IN_SECONDS parameter can be set for an entire account, a user, a session, or a specific warehouse so that you can\ncarefully set time limits that match the expected run times for various workloads. This parameter is set at the account level by default.\nWhen the parameter is set for a warehouse in addition to the session, the lowest non-zero value is enforced.",
        "Use the following commands to view the current query time limits:",
        "If you need to adjust the time limits, use one of the following commands:",
        "SQL statements that are in a queue to use a warehouse do not consume credits. However, if a query stays in the queue too long, it may no\nlonger be relevant by the time it executes. Running a query that is no longer relevant wastes credits, so you can implement a\ncost control by setting a maximum amount of time that a SQL statement can be queued before it is cancelled.",
        "The parameter that controls the amount of time that a SQL statement stays in the queue is STATEMENT_QUEUED_TIMEOUT_IN_SECONDS. This\nparameter can be set for an entire account, a user, a session, or a specific warehouse.  This parameter is set at the account level by\ndefault. When the parameter is set for a warehouse in addition to the session, the lowest non-zero value is enforced.",
        "Use the following commands to view the current queue time limits:",
        "If you need to adjust the time limits, use one of the following commands:",
        "By default, all warehouses have the auto-suspend setting enabled, which means a warehouse automatically shuts down when it is inactive\nfor a defined period of time. A suspended warehouse does not consume credits, so the warehouse only incurs cost when it is processing a\nworkload.",
        "Restricting users from disabling the auto-suspend setting helps to prevent an unused warehouse from wasting credits. You can use\naccess control to allow someone to use a warehouse but also prevent them from modifying its Auto\nSuspend setting.",
        "Query: Find warehouses without auto-suspend",
        "Use the following query to periodically check whether the auto-suspend setting has been disabled for any warehouses.",
        "To enable auto-suspend for the warehouses that have it turned off, open Snowsight, and navigate to\nAdmin \u00bb Warehouses. You can also use the AUTO_SUSPEND parameter of the ALTER WAREHOUSE command.",
        "In general, every warehouse that has auto-suspend enabled should also have auto-resume enabled. The combination of these two settings\nstops and starts a warehouse automatically as the warehouse\u2019s workload fluctuates.",
        "Query: Find warehouses without Auto Resume",
        "The following query lists the warehouses that do not have auto-resume enabled, letting you know which ones need to be modified.",
        "To enable auto-resume for the warehouses that have it turned off, open Snowsight, and navigate to\nAdmin \u00bb Warehouses. You can also use the AUTO_RESUME parameter of the ALTER WAREHOUSE command.",
        "Resource monitors provide the ability to set limits on credits consumed by a warehouse during a specific time interval or date range.\nThis can help prevent warehouses from unintentionally consuming more credits than typically expected.",
        "Sometimes a resource monitor simply notifies an administrator when a credit limit is reached, but you can also enforce a limit by\nconfiguring a resource monitor to suspend a warehouse as soon as the limit is reached. There are two options when enforcing a limit: suspend\nthe warehouse once pending statements are executed or suspend immediately without waiting for statements to complete.",
        "Because a single resource monitor can be set for multiple warehouses or an entire account, you can effectively suspend multiple warehouses\nwhen an overall spending limit is reached. A warehouse can be assigned to its own resource monitor and an account-specific resource monitor\nat the same time; the warehouse is suspended when either of the credit limits is reached.",
        "For more details about suspending warehouses when spending limits are reached, see Working with resource monitors.",
        "Query: Find warehouses without resource monitors",
        "The following query lists the warehouses that have not been assigned to a warehouse-specific resource monitor, which makes them vulnerable\nto runaway costs. Note that the query does not check for account-level resource monitors; warehouses in the list that belong to an account\nthat has an account-level resource monitor are still subject to credit limits.",
        "Note",
        "The cloud services layer of the Snowflake architecture can still incur a small cost if queries are run against a warehouse that has\nbeen suspended by a resource monitor.",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}