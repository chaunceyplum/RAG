{
    "url": "https://docs.snowflake.com/en/developer-guide/native-apps/container-compute-pool",
    "title": "Add a compute pool to an app with containers | Snowflake Documentation",
    "paragraphs": [
        "Feature \u2014 Generally Available",
        "The Snowflake Native App Framework is generally available on supported cloud platforms. For additional information, see\nSupport for private connectivity, VPS, and government regions.",
        "The topic describes how to use compute pools in a Snowflake Native Apps with Snowpark Container Services.",
        "A compute pool is a\ncollection of one or more virtual machine (VM) nodes on which Snowflake runs Snowpark Container Services.\nApps with containers uses a compute pool in the consumer account to manage the container images required by\nthe app.",
        "An app can create multiple compute pools and each compute pool is exclusive to the app. Compute pools\nused by the app cannot be used for other purposes.",
        "Containers within an app can directly access each other, even if they are in different compute pools.",
        "However, using different compute pools allows providers to separate types of services. For example, a\nprovider can separate their frontend services from backend services.",
        "Compute pools are account-level objects, meaning the name of each compute pool must be unique within\nthe consumer account.",
        "Providers should consider the following best practices when creating compute pools a consumer account:",
        "Compute pools have cost implications. It is important to set values for the min_nodes,\nmax_nodes, and instance_family properties to consume the correct amount of resources.\nProviders should also set the AUTO_SUSPEND_SECS property to automatically suspend inactive compute pools.",
        "See CREATE COMPUTE POOL for more information.",
        "Compute pools are account-level objects, as such their pool names must be unique within a consumer account.\nConsider using the application name as a prefix of the compute pool name to ensure uniqueness.",
        "When adding a computer pool to an app with containers that is installed on different cloud service\nproviders, the code used to create the compute pool must account for differences in the instance\nfamilies across different cloud service providers. For example, the HIGHMEM_X64_L instance family\nhas a different configuration for each cloud service provider.",
        "See CREATE COMPUTE POOL for more information on available\ninstance families. See Choose different instance families for each provider for an example of\nhow to set the instance family for different cloud service providers.",
        "Set the uses_gpu property to TRUE only if the app with containers uses a GPU as the\ninstance family of the compute pool. See Set the uses_gpu property in the manifest file for more\ninformation.",
        "There are two ways to create a compute pool for an app with containers:",
        "The app creates the compute pools required during installation. This requires that the\nconsumer grants the CREATE COMPUTE POOL privilege on the compute pool to the app. A\nprovider can configure the app to request these privileges using Snowsight.",
        "See Configure an app to request the CREATE COMPUTE POOL privilege for more information.",
        "The consumer manually creates the compute pools required by the app. The consumer\nmust run the CREATE COMPUTE POOL to create the compute pool, then\nmanually grant the CREATE COMPUTE POOL privilege on the compute pool to the app.",
        "If an app with containers specifies a GPU as the instance family for the Compute Pool, providers\nmust set the uses_gpu flag to true in the manifest. The following example\nshows how to set this flag in the artifacts block:",
        "The automated security scan uses this flag  security scanning framework to validate behavior during the app version scanning process.",
        "Caution",
        "To publish an app with containers on the Snowflake Marketplace, the app must create\nthe required compute pools during installation. See Enforced requirements\nfor the Snowflake Marketplace publication requirements.",
        "Providers can configure an app to request the CREATE COMPUTE POOL privilege. They can\nalso create the compute pool from the setup script when the app is installed or upgraded.",
        "Note",
        "An app can create a maximum of five compute pools in a consumer account. Contact Snowflake support\nif your app needs to create additional compute pools.",
        "An app can request the CREATE COMPUTE POOL privileges from a consumer. This privilege allows the app\nto create a compute pool in the consumer account.\nSee Request global privileges from consumers\nfor general information about requesting global privileges from the consumer.",
        "To request the CREATE COMPUTE POOL privilege from a consumer, add the CREATE COMPUTE POOL privilege to\nthe manifest.yml file as shown in the following example:",
        "See Create the manifest file for an app with containers for more information on creating the manifest.yml file\nfor an app with containers.",
        "Note",
        "The behavior for the CREATE COMPUTE POOL privilege request within a container\napp is different than other privilege requests. When you add this privilege to the\nmanifest.yml file, Snowsight displays an interface that allows a consumer\nto grant the required privileges.",
        "To create a compute pool in the consumer account add the\nCREATE COMPUTE POOL command to the\nsetup script of the app.",
        "The following example shows how to create a compute pool within a stored procedure\nin the setup script:",
        "Note",
        "When creating a compute pool within the app, providers should check that the provider\nhas granted the CREATE COMPUTE POOL privilege before creating the compute pool.",
        "Compute pools that an app creates are owned exclusively by that app. They cannot be used by other\napplications or by the consumer directly.",
        "In general, users in the consumer account can only see compute pools created by the app in the\nfollowing situations:",
        "The user has been granted the MANAGE GRANTS privilege.",
        "The app grants access to the compute pool using application roles.",
        "Application developers can allow users with active roles specific privileges on applications owned by compute pools. In addition, administrators with the ACCOUNTADMIN role can grant themselves the privileges necessary to control the applications owned by compute pools. For more information about compute pool access requirements, see ALTER COMPUTE POOL.",
        "Because compute pools are account-level objects, compute pool names must be unique within\nthe consumer account. The following example shows how to use the application name as a\nprefix of the compute pool name:",
        "When creating a compute pool for an app that is published across multiple cloud\nservice providers, the code that creates the setup script must be written to account\nfor differences in how instance families are configured.",
        "The following example shows how to write a stored procedure to create a compute pool\nbased on the cloud service provider where the app is being installed:",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}