{
    "url": "https://docs.snowflake.com/en/user-guide/tables-iceberg-auto-refresh",
    "title": "Automatically refresh Apache Iceberg\u2122 tables | Snowflake Documentation",
    "paragraphs": [
        "Preview Feature \u2014 Open",
        "Available to all accounts.",
        "Configure automated metadata refreshes for new or existing externally managed\nApache Iceberg\u2122 tables. With automated refreshes, Snowflake polls your external Iceberg catalog in\na continuous and serverless fashion to synchronize the metadata with the most recent remote changes.",
        "Automatic refresh is supported for tables that use the following external catalog options:",
        "AWS Glue",
        "REST catalog that complies with the Apache Iceberg REST OpenAPI specification",
        "Snowflake Open Catalog",
        "When you run the CREATE CATALOG INTEGRATION command,\nyou can specify a value for the REFRESH_INTERVAL_SECONDS parameter. Otherwise, the default refresh interval\nis 30 seconds. Snowflake only polls the external catalog if there are Iceberg tables defined with the catalog integration.",
        "The following example creates a catalog integration for AWS Glue, specifying a refresh interval of 60 seconds:",
        "To update the refresh interval for a catalog integration, use the ALTER CATALOG INTEGRATION command.",
        "For example:",
        "Create an Iceberg table by using the CREATE ICEBERG TABLE command. To specify that the\ntable should use automated metadata refreshes, set AUTO_REFRESH = TRUE.",
        "The following example creates an Iceberg table that uses AWS Glue as the catalog, specifying\nthe catalog integration created previously (auto_refresh_catalog_integration)\nand the CATALOG_TABLE_NAME from AWS Glue.",
        "Note",
        "If the table uses a catalog integration created before Snowflake version 8.22, you must use the\nALTER CATALOG INTEGRATION command to\nset the REFRESH_INTERVAL_SECONDS parameter before you enable automated refresh on the table.",
        "Frequently toggling automated refresh on and off for an Iceberg table can slow metadata refreshes for the table.",
        "Use the ALTER ICEBERG TABLE command to enable or turn off automated refresh for an existing Iceberg table.",
        "For example:",
        "To retrieve the automated refresh status for a table, call the SYSTEM$AUTO_REFRESH_STATUS function.",
        "The function returns details about the pipe that Snowflake uses to automate refreshes for the table, such as the execution state\nand size of the snapshot queue.\nAn execution state of RUNNING indicates that automated refresh is running as expected.\nFor more information, see SYSTEM$AUTO_REFRESH_STATUS.",
        "When an error occurs during the automated refresh process,\nSnowflake updates the execution state to one of the following values:",
        "STALLED means that Snowflake is attempting to recover from the error. If recovery succeeds, the automated refresh process\ncontinues running as expected and the execution state transitions back to the healthy RUNNING state.",
        "STOPPED means the automated refresh process encountered an unrecoverable error, and automated refreshes for the table have been\nstopped.",
        "An unrecoverable error might occur, for example, when Snowflake can\u2019t establish a direct lineage between the target snapshot and the current snapshot.",
        "To recover from a STOPPED state, take the following actions:",
        "Turn off automated refresh on the table.",
        "Perform a manual metadata refresh. For instructions, see Refresh the table metadata.",
        "Re-enable automated refresh using an ALTER ICEBERG TABLE \u2026 SET AUTO_REFRESH statement.",
        "Verify that automated refresh is in the RUNNING state by calling the SYSTEM$AUTO_REFRESH_STATUS function.\nYou can also call the function multiple times to confirm that the number of queued snapshots (pendingSnapshotCount) gradually decreases.",
        "Snowflake uses Snowpipe to automate refreshes for Iceberg tables, so charges for automated refresh appear\nin the same line item on your bill as Snowpipe charges. There are no Snowpipe file charges for this feature.",
        "You can estimate charges incurred by examining the Account Usage PIPE_USAGE_HISTORY view.\nAutomated refresh pipes are listed under a NULL pipe name.",
        "For more information about Iceberg table charges, see Iceberg table billing.",
        "Consider the following when you work with Iceberg tables that use automated refresh:",
        "When automated refresh is enabled, you can\u2019t manually refresh the table metadata. To perform a manual refresh,\nturn off automated refresh first.",
        "For catalog integrations created before Snowflake version 8.22, you must manually set the REFRESH_INTERVAL_SECONDS parameter\nbefore you enable automated refresh on tables that depend on that catalog integration.\nFor instructions, see ALTER CATALOG INTEGRATION \u2026 SET AUTO_REFRESH.",
        "Ensure that the new table snapshot is a direct child of the current table snapshot.\nOtherwise, automated refresh enters the STOPPED state. To recover automated refresh when this occurs, see\nError recovery.",
        "If your table is empty, perform a manual refresh\nbefore you enable automated refresh to avoid undefined behavior.",
        "Automated refresh isn\u2019t supported when you use a catalog integration for object storage.",
        "Iceberg version 1 manifests without a sequence number column aren\u2019t currently supported.",
        "Was this page helpful?",
        "On this page",
        "Related content"
    ]
}